Тяжело получилось даже реализовать, ну поигравшись с дебагом хотя бы понятно как проходит сама операция добавления и поиска